{"ast":null,"code":"import { defineComponent, ref, computed, nextTick, onMounted, watch, resolveComponent, resolveDirective, openBlock, createElementBlock, normalizeClass, Fragment, renderList, createBlock, withCtx, createTextVNode, toDisplayString, createCommentVNode, withDirectives, createVNode, createElementVNode } from 'vue';\nimport { debounce } from 'lodash-unified';\nimport '../../../../directives/index.mjs';\nimport { ElScrollbar } from '../../../scrollbar/index.mjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport { ArrowUp, ArrowDown } from '@element-plus/icons-vue';\nimport { getTimeLists } from './useTimePicker.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport RepeatClick from '../../../../directives/repeat-click/index.mjs';\n\nconst _sfc_main = defineComponent({\n  directives: {\n    repeatClick: RepeatClick\n  },\n  components: {\n    ElScrollbar,\n    ElIcon,\n    ArrowUp,\n    ArrowDown\n  },\n  props: {\n    role: {\n      type: String,\n      required: true\n    },\n    spinnerDate: {\n      type: Object,\n      required: true\n    },\n    showSeconds: {\n      type: Boolean,\n      default: true\n    },\n    arrowControl: Boolean,\n    amPmMode: {\n      type: String,\n      default: \"\"\n    },\n    disabledHours: {\n      type: Function\n    },\n    disabledMinutes: {\n      type: Function\n    },\n    disabledSeconds: {\n      type: Function\n    }\n  },\n  emits: [\"change\", \"select-range\", \"set-option\"],\n\n  setup(props, ctx) {\n    let isScrolling = false;\n    const debouncedResetScroll = debounce(type => {\n      isScrolling = false;\n      adjustCurrentSpinner(type);\n    }, 200);\n    const currentScrollbar = ref(null);\n    const listHoursRef = ref(null);\n    const listMinutesRef = ref(null);\n    const listSecondsRef = ref(null);\n    const listRefsMap = {\n      hours: listHoursRef,\n      minutes: listMinutesRef,\n      seconds: listSecondsRef\n    };\n    const spinnerItems = computed(() => {\n      const arr = [\"hours\", \"minutes\", \"seconds\"];\n      return props.showSeconds ? arr : arr.slice(0, 2);\n    });\n    const hours = computed(() => {\n      return props.spinnerDate.hour();\n    });\n    const minutes = computed(() => {\n      return props.spinnerDate.minute();\n    });\n    const seconds = computed(() => {\n      return props.spinnerDate.second();\n    });\n    const timePartsMap = computed(() => ({\n      hours,\n      minutes,\n      seconds\n    }));\n    const hoursList = computed(() => {\n      return getHoursList(props.role);\n    });\n    const minutesList = computed(() => {\n      return getMinutesList(hours.value, props.role);\n    });\n    const secondsList = computed(() => {\n      return getSecondsList(hours.value, minutes.value, props.role);\n    });\n    const listMap = computed(() => ({\n      hours: hoursList,\n      minutes: minutesList,\n      seconds: secondsList\n    }));\n    const arrowHourList = computed(() => {\n      const hour = hours.value;\n      return [hour > 0 ? hour - 1 : void 0, hour, hour < 23 ? hour + 1 : void 0];\n    });\n    const arrowMinuteList = computed(() => {\n      const minute = minutes.value;\n      return [minute > 0 ? minute - 1 : void 0, minute, minute < 59 ? minute + 1 : void 0];\n    });\n    const arrowSecondList = computed(() => {\n      const second = seconds.value;\n      return [second > 0 ? second - 1 : void 0, second, second < 59 ? second + 1 : void 0];\n    });\n    const arrowListMap = computed(() => ({\n      hours: arrowHourList,\n      minutes: arrowMinuteList,\n      seconds: arrowSecondList\n    }));\n\n    const getAmPmFlag = hour => {\n      const shouldShowAmPm = !!props.amPmMode;\n      if (!shouldShowAmPm) return \"\";\n      const isCapital = props.amPmMode === \"A\";\n      let content = hour < 12 ? \" am\" : \" pm\";\n      if (isCapital) content = content.toUpperCase();\n      return content;\n    };\n\n    const emitSelectRange = type => {\n      if (type === \"hours\") {\n        ctx.emit(\"select-range\", 0, 2);\n      } else if (type === \"minutes\") {\n        ctx.emit(\"select-range\", 3, 5);\n      } else if (type === \"seconds\") {\n        ctx.emit(\"select-range\", 6, 8);\n      }\n\n      currentScrollbar.value = type;\n    };\n\n    const adjustCurrentSpinner = type => {\n      adjustSpinner(type, timePartsMap.value[type].value);\n    };\n\n    const adjustSpinners = () => {\n      adjustCurrentSpinner(\"hours\");\n      adjustCurrentSpinner(\"minutes\");\n      adjustCurrentSpinner(\"seconds\");\n    };\n\n    const adjustSpinner = (type, value) => {\n      if (props.arrowControl) return;\n      const el = listRefsMap[type];\n\n      if (el && el.$el) {\n        el.$el.querySelector(\".el-scrollbar__wrap\").scrollTop = Math.max(0, value * typeItemHeight(type));\n      }\n    };\n\n    const typeItemHeight = type => {\n      const el = listRefsMap[type];\n      return el.$el.querySelector(\"li\").offsetHeight;\n    };\n\n    const onIncreaseClick = () => {\n      scrollDown(1);\n    };\n\n    const onDecreaseClick = () => {\n      scrollDown(-1);\n    };\n\n    const scrollDown = step => {\n      if (!currentScrollbar.value) {\n        emitSelectRange(\"hours\");\n      }\n\n      const label = currentScrollbar.value;\n      let now = timePartsMap.value[label].value;\n      const total = currentScrollbar.value === \"hours\" ? 24 : 60;\n      now = (now + step + total) % total;\n      modifyDateField(label, now);\n      adjustSpinner(label, now);\n      nextTick(() => emitSelectRange(currentScrollbar.value));\n    };\n\n    const modifyDateField = (type, value) => {\n      const list = listMap.value[type].value;\n      const isDisabled = list[value];\n      if (isDisabled) return;\n\n      switch (type) {\n        case \"hours\":\n          ctx.emit(\"change\", props.spinnerDate.hour(value).minute(minutes.value).second(seconds.value));\n          break;\n\n        case \"minutes\":\n          ctx.emit(\"change\", props.spinnerDate.hour(hours.value).minute(value).second(seconds.value));\n          break;\n\n        case \"seconds\":\n          ctx.emit(\"change\", props.spinnerDate.hour(hours.value).minute(minutes.value).second(value));\n          break;\n      }\n    };\n\n    const handleClick = (type, {\n      value,\n      disabled\n    }) => {\n      if (!disabled) {\n        modifyDateField(type, value);\n        emitSelectRange(type);\n        adjustSpinner(type, value);\n      }\n    };\n\n    const handleScroll = type => {\n      isScrolling = true;\n      debouncedResetScroll(type);\n      const value = Math.min(Math.round((listRefsMap[type].$el.querySelector(\".el-scrollbar__wrap\").scrollTop - (scrollBarHeight(type) * 0.5 - 10) / typeItemHeight(type) + 3) / typeItemHeight(type)), type === \"hours\" ? 23 : 59);\n      modifyDateField(type, value);\n    };\n\n    const scrollBarHeight = type => {\n      return listRefsMap[type].$el.offsetHeight;\n    };\n\n    const bindScrollEvent = () => {\n      const bindFuntion = type => {\n        if (listRefsMap[type] && listRefsMap[type].$el) {\n          listRefsMap[type].$el.querySelector(\".el-scrollbar__wrap\").onscroll = () => {\n            handleScroll(type);\n          };\n        }\n      };\n\n      bindFuntion(\"hours\");\n      bindFuntion(\"minutes\");\n      bindFuntion(\"seconds\");\n    };\n\n    onMounted(() => {\n      nextTick(() => {\n        !props.arrowControl && bindScrollEvent();\n        adjustSpinners();\n        if (props.role === \"start\") emitSelectRange(\"hours\");\n      });\n    });\n\n    const setRef = (scrollbar, type) => {\n      listRefsMap[type] = scrollbar;\n    };\n\n    ctx.emit(\"set-option\", [`${props.role}_scrollDown`, scrollDown]);\n    ctx.emit(\"set-option\", [`${props.role}_emitSelectRange`, emitSelectRange]);\n    const {\n      getHoursList,\n      getMinutesList,\n      getSecondsList\n    } = getTimeLists(props.disabledHours, props.disabledMinutes, props.disabledSeconds);\n    watch(() => props.spinnerDate, () => {\n      if (isScrolling) return;\n      adjustSpinners();\n    });\n    return {\n      setRef,\n      spinnerItems,\n      currentScrollbar,\n      hours,\n      minutes,\n      seconds,\n      hoursList,\n      minutesList,\n      arrowHourList,\n      arrowMinuteList,\n      arrowSecondList,\n      getAmPmFlag,\n      emitSelectRange,\n      adjustCurrentSpinner,\n      typeItemHeight,\n      listHoursRef,\n      listMinutesRef,\n      listSecondsRef,\n      onIncreaseClick,\n      onDecreaseClick,\n      handleClick,\n      secondsList,\n      timePartsMap,\n      arrowListMap,\n      listMap\n    };\n  }\n\n});\n\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = [\"onMouseenter\"];\nconst _hoisted_3 = {\n  class: \"el-time-spinner__list\"\n};\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_scrollbar = resolveComponent(\"el-scrollbar\");\n\n  const _component_arrow_up = resolveComponent(\"arrow-up\");\n\n  const _component_el_icon = resolveComponent(\"el-icon\");\n\n  const _component_arrow_down = resolveComponent(\"arrow-down\");\n\n  const _directive_repeat_click = resolveDirective(\"repeat-click\");\n\n  return openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass([\"el-time-spinner\", {\n      \"has-seconds\": _ctx.showSeconds\n    }])\n  }, [!_ctx.arrowControl ? (openBlock(true), createElementBlock(Fragment, {\n    key: 0\n  }, renderList(_ctx.spinnerItems, item => {\n    return openBlock(), createBlock(_component_el_scrollbar, {\n      key: item,\n      ref_for: true,\n      ref: scollbar => _ctx.setRef(scollbar, item),\n      class: \"el-time-spinner__wrapper\",\n      \"wrap-style\": \"max-height: inherit;\",\n      \"view-class\": \"el-time-spinner__list\",\n      noresize: \"\",\n      tag: \"ul\",\n      onMouseenter: $event => _ctx.emitSelectRange(item),\n      onMousemove: $event => _ctx.adjustCurrentSpinner(item)\n    }, {\n      default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.listMap[item].value, (disabled, key) => {\n        return openBlock(), createElementBlock(\"li\", {\n          key,\n          class: normalizeClass([\"el-time-spinner__item\", {\n            active: key === _ctx.timePartsMap[item].value,\n            disabled\n          }]),\n          onClick: $event => _ctx.handleClick(item, {\n            value: key,\n            disabled\n          })\n        }, [item === \"hours\" ? (openBlock(), createElementBlock(Fragment, {\n          key: 0\n        }, [createTextVNode(toDisplayString((\"0\" + (_ctx.amPmMode ? key % 12 || 12 : key)).slice(-2)) + toDisplayString(_ctx.getAmPmFlag(key)), 1)], 2112)) : (openBlock(), createElementBlock(Fragment, {\n          key: 1\n        }, [createTextVNode(toDisplayString((\"0\" + key).slice(-2)), 1)], 2112))], 10, _hoisted_1);\n      }), 128))]),\n      _: 2\n    }, 1032, [\"onMouseenter\", \"onMousemove\"]);\n  }), 128)) : createCommentVNode(\"v-if\", true), _ctx.arrowControl ? (openBlock(true), createElementBlock(Fragment, {\n    key: 1\n  }, renderList(_ctx.spinnerItems, item => {\n    return openBlock(), createElementBlock(\"div\", {\n      key: item,\n      class: \"el-time-spinner__wrapper is-arrow\",\n      onMouseenter: $event => _ctx.emitSelectRange(item)\n    }, [withDirectives((openBlock(), createBlock(_component_el_icon, {\n      class: \"el-time-spinner__arrow arrow-up\"\n    }, {\n      default: withCtx(() => [createVNode(_component_arrow_up)]),\n      _: 1\n    })), [[_directive_repeat_click, _ctx.onDecreaseClick]]), withDirectives((openBlock(), createBlock(_component_el_icon, {\n      class: \"el-time-spinner__arrow arrow-down\"\n    }, {\n      default: withCtx(() => [createVNode(_component_arrow_down)]),\n      _: 1\n    })), [[_directive_repeat_click, _ctx.onIncreaseClick]]), createElementVNode(\"ul\", _hoisted_3, [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.arrowListMap[item].value, (time, key) => {\n      return openBlock(), createElementBlock(\"li\", {\n        key,\n        class: normalizeClass([\"el-time-spinner__item\", {\n          active: time === _ctx.timePartsMap[item].value,\n          disabled: _ctx.listMap[item].value[time]\n        }])\n      }, [typeof time === \"number\" ? (openBlock(), createElementBlock(Fragment, {\n        key: 0\n      }, [item === \"hours\" ? (openBlock(), createElementBlock(Fragment, {\n        key: 0\n      }, [createTextVNode(toDisplayString((\"0\" + (_ctx.amPmMode ? time % 12 || 12 : time)).slice(-2)) + toDisplayString(_ctx.getAmPmFlag(time)), 1)], 2112)) : (openBlock(), createElementBlock(Fragment, {\n        key: 1\n      }, [createTextVNode(toDisplayString((\"0\" + time).slice(-2)), 1)], 2112))], 2112)) : createCommentVNode(\"v-if\", true)], 2);\n    }), 128))])], 40, _hoisted_2);\n  }), 128)) : createCommentVNode(\"v-if\", true)], 2);\n}\n\nvar TimeSpinner = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\n\nexport { TimeSpinner as default };","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","directives","repeatClick","components","ElScrollbar","ElIcon","ArrowUp","ArrowDown","props","role","type","required","spinnerDate","showSeconds","default","arrowControl","amPmMode","disabledHours","disabledMinutes","disabledSeconds","emits","setup","ctx","isScrolling","debounce","adjustCurrentSpinner","currentScrollbar","ref","listHoursRef","listMinutesRef","listSecondsRef","listRefsMap","hours","minutes","seconds","computed","arr","slice","hour","minute","second","getHoursList","getSecondsList","value","shouldShowAmPm","content","adjustSpinner","timePartsMap","adjustSpinners","el","$el","querySelector","scrollTop","Math","max","typeItemHeight","offsetHeight","onIncreaseClick","scrollDown","onDecreaseClick","step","emitSelectRange","label","total","now","modifyDateField","nextTick","listMap","isDisabled","list","handleClick","disabled","debouncedResetScroll","min","round","bindScrollEvent","onscroll","handleScroll","bindFuntion","onMounted","scrollbar","emit","getMinutesList","getTimeLists","watch","setRef","spinnerItems","hoursList","minutesList","arrowHourList","arrowMinuteList","arrowSecondList","getAmPmFlag","secondsList","arrowListMap","class","_createElementBlock","_normalizeClass","key","_ctx","item","_createBlock","ref_for","scollbar","noresize","tag","onMouseenter","$event","onMousemove","_Fragment","_renderList","active","onClick","openBlock","_toDisplayString","_openBlock","_createVNode","_","_withDirectives","_component_el_icon","_createElementVNode","time"],"sources":["../../../../../../../packages/components/time-picker/src/time-picker-com/basic-time-spinner.vue"],"sourcesContent":["<template>\n  <div class=\"el-time-spinner\" :class=\"{ 'has-seconds': showSeconds }\">\n    <template v-if=\"!arrowControl\">\n      <el-scrollbar\n        v-for=\"item in spinnerItems\"\n        :key=\"item\"\n        :ref=\"(scollbar) => setRef(scollbar, item)\"\n        class=\"el-time-spinner__wrapper\"\n        wrap-style=\"max-height: inherit;\"\n        view-class=\"el-time-spinner__list\"\n        noresize\n        tag=\"ul\"\n        @mouseenter=\"emitSelectRange(item)\"\n        @mousemove=\"adjustCurrentSpinner(item)\"\n      >\n        <li\n          v-for=\"(disabled, key) in listMap[item].value\"\n          :key=\"key\"\n          class=\"el-time-spinner__item\"\n          :class=\"{ active: key === timePartsMap[item].value, disabled }\"\n          @click=\"handleClick(item, { value: key, disabled })\"\n        >\n          <template v-if=\"item === 'hours'\">\n            {{ ('0' + (amPmMode ? key % 12 || 12 : key)).slice(-2)\n            }}{{ getAmPmFlag(key) }}\n          </template>\n          <template v-else>\n            {{ ('0' + key).slice(-2) }}\n          </template>\n        </li>\n      </el-scrollbar>\n    </template>\n    <template v-if=\"arrowControl\">\n      <div\n        v-for=\"item in spinnerItems\"\n        :key=\"item\"\n        class=\"el-time-spinner__wrapper is-arrow\"\n        @mouseenter=\"emitSelectRange(item)\"\n      >\n        <el-icon\n          v-repeat-click=\"onDecreaseClick\"\n          class=\"el-time-spinner__arrow arrow-up\"\n        >\n          <arrow-up />\n        </el-icon>\n        <el-icon\n          v-repeat-click=\"onIncreaseClick\"\n          class=\"el-time-spinner__arrow arrow-down\"\n        >\n          <arrow-down />\n        </el-icon>\n        <ul class=\"el-time-spinner__list\">\n          <li\n            v-for=\"(time, key) in arrowListMap[item].value\"\n            :key=\"key\"\n            class=\"el-time-spinner__item\"\n            :class=\"{\n              active: time === timePartsMap[item].value,\n              disabled: listMap[item].value[time],\n            }\"\n          >\n            <template v-if=\"typeof time === 'number'\">\n              <template v-if=\"item === 'hours'\">\n                {{ ('0' + (amPmMode ? time % 12 || 12 : time)).slice(-2)\n                }}{{ getAmPmFlag(time) }}\n              </template>\n              <template v-else>\n                {{ ('0' + time).slice(-2) }}\n              </template>\n            </template>\n          </li>\n        </ul>\n      </div>\n    </template>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, ref, nextTick, computed, onMounted, watch } from 'vue'\nimport { debounce } from 'lodash-unified'\nimport { RepeatClick } from '@element-plus/directives'\nimport ElScrollbar from '@element-plus/components/scrollbar'\nimport ElIcon from '@element-plus/components/icon'\nimport { ArrowUp, ArrowDown } from '@element-plus/icons-vue'\nimport { getTimeLists } from './useTimePicker'\n\nimport type { PropType, Ref } from 'vue'\nimport type { Dayjs } from 'dayjs'\nimport type { Nullable } from '@element-plus/utils'\n\nexport default defineComponent({\n  directives: {\n    repeatClick: RepeatClick,\n  },\n\n  components: {\n    ElScrollbar,\n    ElIcon,\n    ArrowUp,\n    ArrowDown,\n  },\n\n  props: {\n    role: {\n      type: String,\n      required: true,\n    },\n    spinnerDate: {\n      type: Object as PropType<Dayjs>,\n      required: true,\n    },\n    showSeconds: {\n      type: Boolean,\n      default: true,\n    },\n    arrowControl: Boolean,\n    amPmMode: {\n      type: String,\n      default: '', // 'a': am/pm; 'A': AM/PM\n    },\n    disabledHours: {\n      type: Function,\n    },\n    disabledMinutes: {\n      type: Function,\n    },\n    disabledSeconds: {\n      type: Function,\n    },\n  },\n\n  emits: ['change', 'select-range', 'set-option'],\n\n  setup(props, ctx) {\n    // data\n    let isScrolling = false\n    const debouncedResetScroll = debounce((type) => {\n      isScrolling = false\n      adjustCurrentSpinner(type)\n    }, 200)\n    const currentScrollbar = ref(null)\n    const listHoursRef: Ref<Nullable<HTMLElement>> = ref(null)\n    const listMinutesRef: Ref<Nullable<HTMLElement>> = ref(null)\n    const listSecondsRef: Ref<Nullable<HTMLElement>> = ref(null)\n    const listRefsMap = {\n      hours: listHoursRef,\n      minutes: listMinutesRef,\n      seconds: listSecondsRef,\n    }\n\n    // computed\n    const spinnerItems = computed(() => {\n      const arr = ['hours', 'minutes', 'seconds']\n      return props.showSeconds ? arr : arr.slice(0, 2)\n    })\n    const hours = computed(() => {\n      return props.spinnerDate.hour()\n    })\n    const minutes = computed(() => {\n      return props.spinnerDate.minute()\n    })\n    const seconds = computed(() => {\n      return props.spinnerDate.second()\n    })\n    const timePartsMap = computed(() => ({\n      hours,\n      minutes,\n      seconds,\n    }))\n    const hoursList = computed(() => {\n      return getHoursList(props.role)\n    })\n    const minutesList = computed(() => {\n      return getMinutesList(hours.value, props.role)\n    })\n    const secondsList = computed(() => {\n      return getSecondsList(hours.value, minutes.value, props.role)\n    })\n    const listMap = computed(() => ({\n      hours: hoursList,\n      minutes: minutesList,\n      seconds: secondsList,\n    }))\n    const arrowHourList = computed(() => {\n      const hour = hours.value\n      return [\n        hour > 0 ? hour - 1 : undefined,\n        hour,\n        hour < 23 ? hour + 1 : undefined,\n      ]\n    })\n    const arrowMinuteList = computed(() => {\n      const minute = minutes.value\n      return [\n        minute > 0 ? minute - 1 : undefined,\n        minute,\n        minute < 59 ? minute + 1 : undefined,\n      ]\n    })\n    const arrowSecondList = computed(() => {\n      const second = seconds.value\n      return [\n        second > 0 ? second - 1 : undefined,\n        second,\n        second < 59 ? second + 1 : undefined,\n      ]\n    })\n    const arrowListMap = computed(() => ({\n      hours: arrowHourList,\n      minutes: arrowMinuteList,\n      seconds: arrowSecondList,\n    }))\n    const getAmPmFlag = (hour) => {\n      const shouldShowAmPm = !!props.amPmMode\n      if (!shouldShowAmPm) return ''\n      const isCapital = props.amPmMode === 'A'\n      // todo locale\n      let content = hour < 12 ? ' am' : ' pm'\n      if (isCapital) content = content.toUpperCase()\n      return content\n    }\n\n    const emitSelectRange = (type) => {\n      if (type === 'hours') {\n        ctx.emit('select-range', 0, 2)\n      } else if (type === 'minutes') {\n        ctx.emit('select-range', 3, 5)\n      } else if (type === 'seconds') {\n        ctx.emit('select-range', 6, 8)\n      }\n      currentScrollbar.value = type\n    }\n\n    const adjustCurrentSpinner = (type) => {\n      adjustSpinner(type, timePartsMap.value[type].value)\n    }\n\n    // NOTE: used by datetime / date-range panel\n    //       renamed from adjustScrollTop\n    //       should try to refactory it\n    const adjustSpinners = () => {\n      adjustCurrentSpinner('hours')\n      adjustCurrentSpinner('minutes')\n      adjustCurrentSpinner('seconds')\n    }\n\n    const adjustSpinner = (type, value) => {\n      if (props.arrowControl) return\n      const el = listRefsMap[type]\n      if (el && el.$el) {\n        el.$el.querySelector('.el-scrollbar__wrap').scrollTop = Math.max(\n          0,\n          value * typeItemHeight(type)\n        )\n      }\n    }\n\n    const typeItemHeight = (type) => {\n      const el = listRefsMap[type]\n      return el.$el.querySelector('li').offsetHeight\n    }\n\n    const onIncreaseClick = () => {\n      scrollDown(1)\n    }\n\n    const onDecreaseClick = () => {\n      scrollDown(-1)\n    }\n\n    const scrollDown = (step) => {\n      if (!currentScrollbar.value) {\n        emitSelectRange('hours')\n      }\n\n      const label = currentScrollbar.value\n      let now = timePartsMap.value[label].value\n      const total = currentScrollbar.value === 'hours' ? 24 : 60\n      now = (now + step + total) % total\n\n      modifyDateField(label, now)\n      adjustSpinner(label, now)\n      nextTick(() => emitSelectRange(currentScrollbar.value))\n    }\n\n    const modifyDateField = (type, value) => {\n      const list = listMap.value[type].value\n      const isDisabled = list[value]\n      if (isDisabled) return\n      switch (type) {\n        case 'hours':\n          ctx.emit(\n            'change',\n            props.spinnerDate\n              .hour(value)\n              .minute(minutes.value)\n              .second(seconds.value)\n          )\n          break\n        case 'minutes':\n          ctx.emit(\n            'change',\n            props.spinnerDate\n              .hour(hours.value)\n              .minute(value)\n              .second(seconds.value)\n          )\n          break\n        case 'seconds':\n          ctx.emit(\n            'change',\n            props.spinnerDate\n              .hour(hours.value)\n              .minute(minutes.value)\n              .second(value)\n          )\n          break\n      }\n    }\n\n    const handleClick = (type, { value, disabled }) => {\n      if (!disabled) {\n        modifyDateField(type, value)\n        emitSelectRange(type)\n        adjustSpinner(type, value)\n      }\n    }\n\n    const handleScroll = (type) => {\n      isScrolling = true\n      debouncedResetScroll(type)\n      const value = Math.min(\n        Math.round(\n          (listRefsMap[type].$el.querySelector('.el-scrollbar__wrap')\n            .scrollTop -\n            (scrollBarHeight(type) * 0.5 - 10) / typeItemHeight(type) +\n            3) /\n            typeItemHeight(type)\n        ),\n        type === 'hours' ? 23 : 59\n      )\n      modifyDateField(type, value)\n    }\n\n    const scrollBarHeight = (type) => {\n      return listRefsMap[type].$el.offsetHeight\n    }\n\n    const bindScrollEvent = () => {\n      const bindFuntion = (type) => {\n        if (listRefsMap[type] && listRefsMap[type].$el) {\n          listRefsMap[type].$el.querySelector('.el-scrollbar__wrap').onscroll =\n            () => {\n              // TODO: scroll is emitted when set scrollTop programatically\n              // should find better solutions in the future!\n              handleScroll(type)\n            }\n        }\n      }\n      bindFuntion('hours')\n      bindFuntion('minutes')\n      bindFuntion('seconds')\n    }\n\n    onMounted(() => {\n      nextTick(() => {\n        !props.arrowControl && bindScrollEvent()\n        adjustSpinners()\n        // set selection on the first hour part\n        if (props.role === 'start') emitSelectRange('hours')\n      })\n    })\n\n    const setRef = (scrollbar, type) => {\n      listRefsMap[type] = scrollbar\n    }\n\n    ctx.emit('set-option', [`${props.role}_scrollDown`, scrollDown])\n    ctx.emit('set-option', [`${props.role}_emitSelectRange`, emitSelectRange])\n\n    const { getHoursList, getMinutesList, getSecondsList } = getTimeLists(\n      props.disabledHours,\n      props.disabledMinutes,\n      props.disabledSeconds\n    )\n\n    watch(\n      () => props.spinnerDate,\n      () => {\n        if (isScrolling) return\n        adjustSpinners()\n      }\n    )\n\n    return {\n      setRef,\n      spinnerItems,\n      currentScrollbar,\n      hours,\n      minutes,\n      seconds,\n      hoursList,\n      minutesList,\n      arrowHourList,\n      arrowMinuteList,\n      arrowSecondList,\n      getAmPmFlag,\n      emitSelectRange,\n      adjustCurrentSpinner,\n      typeItemHeight,\n      listHoursRef,\n      listMinutesRef,\n      listSecondsRef,\n      onIncreaseClick,\n      onDecreaseClick,\n      handleClick,\n      secondsList,\n      timePartsMap,\n      arrowListMap,\n      listMap,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}